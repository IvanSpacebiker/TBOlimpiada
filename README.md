# Инструкция по сборке и запуску приложения

---

## Предварительные требования

Перед началом работы убедитесь, что у вас установлены следующие компоненты:

1. **Docker** - [Ссылка для установки](https://docs.docker.com/get-docker/)
2. **Docker Compose** (часть Docker Desktop или отдельная установка) - [Ссылка для установки](https://docs.docker.com/compose/install/)

Также убедитесь, что в вашей системе настроены переменные окружения, используемые в `docker-compose.yml`:

- `POSTGRES_USER`
- `POSTGRES_PASSWORD`
- `POSTGRES_DB`
- `ENCRYPTION_SECRET`

Если переменные не настроены, создайте файл `.env` в корне проекта и добавьте туда необходимые значения в формате:

```env
POSTGRES_USER=your_user
POSTGRES_PASSWORD=your_password
POSTGRES_DB=your_database
ENCRYPTION_SECRET=your_secret_key
```

---

## Структура проекта

Проект состоит из следующих компонентов:

1. **MailHog** - сервис для тестирования отправки email.
2. **PostgreSQL** - база данных.
3. **Backend** - серверное приложение, которое взаимодействует с базой данных и MailHog.
4. **Frontend** - клиентское приложение, доступное через браузер.

---

## Шаги по сборке и запуску

### 1. Клонирование репозитория

Склонируйте репозиторий с кодом приложения на ваш локальный компьютер:

```bash
git clone https://github.com/IvanSpacebiker/TBOlimpiada.git
cd TBOlimpiada
```

### 2. Создание файла `.env`

Создайте файл `.env` в корне проекта и заполните его переменными окружения:

```env
POSTGRES_USER=your_user
POSTGRES_PASSWORD=your_password
POSTGRES_DB=your_database
ENCRYPTION_SECRET=your_secret_key
```

> **Важно!** Значения переменных должны соответствовать требованиям приложения. ENCRYPTION_SECRET должен подходить для алгоритма шифрования "AES" после его кодирования в Base64. Если вы сомневаетесь, то можете не вводить эту переменную, ENCRYPTION_SECRET примет значение по умолчанию.


### 3. Сборка и запуск контейнеров

Запустите сборку и запуск всех контейнеров с помощью команды:

```bash
docker-compose up --build
```

- Флаг `--build` указывает, что необходимо пересобрать образы перед запуском.
- Если вы хотите запустить контейнеры в фоновом режиме, добавьте флаг `-d`:

```bash
docker-compose up --build -d
```

### 4. Проверка работоспособности

После успешного запуска проверьте работу каждого компонента:

1. **Frontend**:
    - Откройте браузер и перейдите по адресу: `http://localhost`.
    - Вы должны увидеть интерфейс вашего приложения.

2. **MailHog**:
    - Откройте браузер и перейдите по адресу: `http://localhost:8025`.
    - Здесь вы можете просматривать отправленные письма.

3. **Backend**:
    - Backend работает на порту `8080` внутри контейнера. Для проверки его работоспособности используйте инструменты, такие как `curl` или Postman, чтобы отправить запросы к API.

4. **PostgreSQL**:
    - База данных доступна на порту `5432`. Вы можете подключиться к ней с помощью клиента, например, `pgAdmin`, используя данные из `.env`.

---

## Остановка и удаление контейнеров

Чтобы остановить и удалить все контейнеры, выполните команду:

```bash
docker-compose down
```

Если вы хотите также удалить том (volume) с данными PostgreSQL, добавьте флаг `-v`:

```bash
docker-compose down -v
```

---


## Возможные проблемы и их решение

1. **Ошибка "Port is already allocated"**:
    - Убедитесь, что порты `80`, `8025`, `1025` и `5432` не заняты другими процессами.
    - Измените порты в `docker-compose.yml`, если необходимо.

2. **Проблемы с переменными окружения**:
    - Проверьте правильность значений в файле `.env`.
    - Убедитесь, что файл `.env` находится в корне проекта.

3. **Backend не может подключиться к базе данных**:
    - Убедитесь, что контейнер `db` запущен.
    - Проверьте правильность URI подключения в переменной `POSTGRES_URI`.

---  
